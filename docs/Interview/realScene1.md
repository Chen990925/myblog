---
group: 业务场景方面面试题
title: 业务场景方面面试题1
order: 1
---

# **业务场景方面面试题**

### 1.**是否定义、设计过业务模型？**

**答案解析思路**：这个问题看似“高大上”，但其实非常简单。所谓的业务模型就是将**需求转换成程序之后，设计的数据库和数据表**，所以在开发中你一定定义过或设计过业务模型。

理解需求->分析需求->建立关系和依赖->设计业务逻辑->持久化数据模型

>  在设计数据库的整个过程中，要遵循数据库的“三范式”。



### **2.如何防止重复提交订单？(如何保证幂等性)**

重复提交原因

- 一种是由于用户在短时间内多次点击下单按钮，或浏览器刷新按钮导致。
- 另一种则是由于Nginx或类似于SpringCloud Gateway的网关层，进行超时重试造成的。

**方案一：提交订单按钮置灰**

这种解决方案在注册登录的场景下比较常见，当我们点击”发送验证码“按钮的时候，会进行手机短信验证码发送，且按钮就会有一分钟左右的置灰。

但这种方案只能解决多次点击下单按钮的问题，对于Nginx或类似于SpringCloud Gateway的超时重试所导致的问题是无能为力的。

当然，这种方案也不是真的没有价值。它可以在高并发场景下，从浏览器端去拦住一部分请求，减少后端服务器的处理压力。

**方案二：预生成全局唯一订单号**

（1）后端新增一个接口，用于预生成一个“全局唯一订单号”

> 该“全局唯一订单号”不能代替数据库主键，在未分库分表场景下，主键还是用数据库自增ID比较好。

（2）进入创建订单页面时，前端请求该接口，**获取该订单号**。

（3）在提交订单时，请求参数里要带上这个预生成的“全局唯一订单号”，利用数据库的唯一索引特性，在插入订单记录时，如果该“全局唯一的订单号”重复，记录会插入失败。

**方案三：前端自己生成全局唯一订单号** 简化了一定的逻辑不用请求接口了

**方案四：从订单业务的本质入手**

`如何防止重复提交订单`，其实就是**防止在短时间内，用户和商品进行多次连接**。

可以用 `用户ID + 分隔符 + 商品ID` 作为唯一标识，让持有相同标识的请求在短时间内不能重复下单，不就可以了吗？而且，Redis不正是做这种解决方案的利器吗？

把`用户ID + 分隔符 + 商品ID`作为Redis key，并把”短时间所对应的秒数“设置为seconds，让它过期自动删除。


